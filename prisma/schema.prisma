datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        Int            @id @default(autoincrement())
  email     String         @unique
  password  String
  name      String?
  history   WatchHistory[]
  ratings   Rating[]
  createdAt DateTime       @default(now())
}

model WatchHistory {
  id        Int      @id @default(autoincrement())
  userId    Int
  movieId   Int
  watchedAt DateTime @default(now())

  user  User  @relation(fields: [userId], references: [id])
  movie Movie @relation(fields: [movieId], references: [id])
}

model Rating {
  id       Int    @id @default(autoincrement())
  stars    Int
  comment  String?
  userId   Int
  movieId  Int

  user  User  @relation(fields: [userId], references: [id])
  movie Movie @relation(fields: [movieId], references: [id])
}

model MovieView {
  movieId Int  @id
  views   Int  @default(0)
  movie   Movie @relation(fields: [movieId], references: [id])
}
model Movie {
  id            Int           @id @default(autoincrement())
  title         String
  overview      String?
  release       DateTime?
  createdAt     DateTime      @default(now())
  isRecommended Boolean       @default(false) //  AJOUT OBLIGATOIRE

  history       WatchHistory[]
  ratings       Rating[]
  view          MovieView?
}
